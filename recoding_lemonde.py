import pandas as pd
import glob


def import_data(folder):
    frames = []
    for file_path in glob.glob('%s/*.json' % path):
        article = pd.read_json(file_path, typ='series').to_frame('index').transpose()
        frames.append(article)
    df = pd.concat(frames)
    df.sort_values(by=['theme'], inplace=True)
    df.reset_index(drop=True, inplace=True)
    return df

path = './target_press_article/lemonde'
df = import_data(path)

# print themes labels
print(set(df['theme'].values))
uniquesCat = list(set(df["theme"]))

# print article from a category
print(df['title'][df['theme'] == 'm voyage'].values[0:]) # print les 2 premiers articles
print(df['title'][df['theme'] == 'm voyage'].count()) # print les 2 premiers articles

categories = [
        'international', # politique etrangere, voyage
        'politique fr', 
        'france', # actu fait divers en france NON POLITIQUE
        'economie', 
        'sciences/high-tech', # jeux video
        'arts et culture', # gastronomie, mode, arts, cinema, voyages, litterature
        'sports', # automobile
        'sante'
        ]

dict_lemonde = {'actualite medias' : 'france',
 'addictions' : 'sante',
 'affaire baupin' : 'france',
 'affaire de la sextape de valbuena' : 'france',
 'affaire penelope fillon' : 'politique fr',
 'afrique' : 'international',
 'al qaida' : 'international',
 'ameriques' : 'international',
 'archeologie' : 'arts et culture',
 'architecture' : 'arts et culture',
 'archives' : 'delete',
 'argent' : 'economie',
 'arts' : 'arts et culture',
 'asie pacifique' : 'international',
 'athletisme' : 'sports',
 'attaques a paris' : 'france',
 'attentat de manchester' : 'international',
 'auto moto' : 'sports',
 'automobile' : 'sports',
 'bac lycee' : 'france',
 'bande dessinee' : 'arts et culture',
 'basket' : 'sports',
 'big browser' : 'international',
 'biodiversite' : 'sciences/high-tech',
 'bleds a part' : 'france',
 'brevet college' : 'france',
 'campus' : 'arts et culture',
 'chronique des communs' : 'delete',
 'cinema' : 'arts et culture',
 'citynnovation' : 'sciences/high-tech',
 'climat' : 'politique fr',
 'collection musee ideal' : 'arts et culture',
 'collection mythologie' : 'arts et culture',
 'commerce gestion' : 'economie',
 'concours' : 'delete',
 'conferences climat' : 'politique fr',
 'corse' : 'france',
 'cosmos' : 'international',
 'cotecourscotesjardins' : 'arts et culture',
 'culture' : 'arts et culture',
 'cyclisme' : 'sports',
 'decryptages' : 'delete',
 'demographie' : 'international',
 'disparitions' : 'arts et culture',
 'djihad online' : 'international',
 'donald trump' : 'international',
 'droit sciences po' : 'sciences/high-tech',
 'economie' : 'economie',
 'economie francaise' : 'economie',
 'economie mondiale' : 'economie',
 'education' : 'arts et culture',
 'election presidentielle 2017' : 'politique fr',
 'elections' : 'politique fr',
 'elections americaines' : 'international',
 'elections legislatives 2017' : 'politique fr',
 'elections senatoriales' : 'politique fr',
 'emmanuel macron' : 'politique fr',
 'emploi' : 'politique fr',
 'en bref' : 'delete',
 'energies' : 'politique fr',
 'entre les lignes' : 'delete',
 'entreprises' : 'economie',
 'europe' : 'international',
 'evasion fiscale' : 'economie',
 'fashion week' : 'arts et culture',
 'femmes a part' : 'delete',
 'festival' : 'arts et culture',
 'festival de cannes' : 'arts et culture',
 'fin de vie' : 'delete',
 'financement de la sante' : 'economie',
 'football' : 'sports',
 'formule 1' : 'sports',
 'golf' : 'sports',
 'gouvernement philippe' : 'politique fr',
 'gymnastique' : 'sports',
 'handball' : 'sports',
 'hillary clinton' : 'international',
 'idees' : 'arts et culture',
 'immigration et diversite' : 'international',
 'immobilier' : 'economie',
 'international' : 'international',
 'jeux olympiques pyeongchang 2018' : 'sports',
 'jeux olympiques rio 2016' : 'sports',
 'judo' : 'sports',
 'la foire du drone' : 'sciences/high-tech',
 'la france insoumise' : 'politique fr',
 'la matinale' : 'politique fr',
 'la republique en marche' : 'politique fr',
 'le blog du decodex' : 'delete',
 'les decodeurs' : 'arts et culture',
 'les enfants akira' : 'arts et culture',
 'les nouveaux arrivants' : 'international',
 'ligue 1' : 'sports',
 'ligue des champions' : 'sports',
 'livres' : 'arts et culture',
 'logement' : 'economie',
 'logiciel de racket wannacry' : 'sciences/high-tech',
 'lycee' : 'arts et culture',
 'm actu' : 'france',
 'm actu chroniques' : 'france',
 'm beaute' : 'arts et culture',
 'm design deco' : 'arts et culture',
 'm gastronomie' : 'arts et culture',
 'm gastronomie le lieu' : 'arts et culture',
 'm gens portrait' : 'arts et culture',
 'm horlogerie joaillerie' : 'arts et culture',
 'm le mag' : 'arts et culture',
 'm mode' : 'arts et culture',
 'm mode business of fashion' : 'arts et culture',
 'm moyen format' : 'arts et culture',
 'm perso' : 'delete',
 'm styles' : 'arts et culture',
 'm voiture' : 'sports',
 'm voiture banc d essai' : 'sports',
 'm voyage' : 'arts et culture',
 'm voyage le lieu' : 'arts et culture',
 'marches financiers' : 'economie',
 'medecine' : 'sante',
 'meurtres de policiers a magnanville' : 'france',
 'mondial 2018' : 'sports',
 'mort de france gall' : 'arts et culture',
 'mort de simone veil' : 'arts et culture',
 'moyen orient irak' : 'international',
 'musiques' : 'arts et culture',
 'nutrition' : 'sante',
 'o21' : 'delete',
 'one planet summit' : 'delete',
 'organisations internationales' : 'international',
 'paleontologie' : 'sciences/high-tech',
 'paradise papers' : 'international',
 'partir a l etranger' : 'arts et culture',
 'photo' : 'arts et culture',
 'pixels' : 'sciences/high-tech',
 'planete' : 'sciences/high-tech',
 'police justice' : 'france',
 'politique' : 'politique fr',
 'pollution' : 'politique fr',
 'prix nobel' : 'international',
 'proche orient' : 'international',
 'referendum sur le brexit' : 'international',
 'religions' : 'politique fr',
 'roland garros' : 'sports',
 'rugby' : 'sports',
 'sante' : 'sante',
 'scenes' : 'arts et culture',
 'sciences' : 'sciences/high-tech',
 'securite sanitaire' : 'sante',
 'ski' : 'sports',
 'smart cities' : 'sciences/high-tech',
 'societe' : 'politique fr',
 'sport' : 'sports',
 'sport et societe' : 'sports',
 'sports de combat' : 'sports',
 'sports de glisse' : 'sports',
 'sports mecaniques' : 'sports',
 'sports mecaniques formule 1' : 'sports',
 'sports us' : 'sports',
 'syrie' : 'international',
 'tant de temps' : 'delete',
 'technologies' : 'sciences/high-tech',
 'televisions radio' : 'arts et culture',
 'tempete harvey' : 'international',
 'tennis' : 'sports',
 'the rolling stones' : 'arts et culture',
 'top 14' : 'sports',
 'tour de france' : 'sports',
 'universites' : 'arts et culture',
 'vins' : 'arts et culture',
 'violences policieres' : 'politique fr',
 'voile' : 'sports',
 'volley' : 'sports',
 'yemen' : 'international'}

# Recode categories
df['new_cat'] = df['theme'].map(dict_lemonde)
df.to_json('lemonde_new_cat.json', orient='index')